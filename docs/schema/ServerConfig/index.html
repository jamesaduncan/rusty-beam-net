<!DOCTYPE html>
<html>
<head>
    <title>ServerConfig Schema - Rusty Beam</title>
    <style>
        body { font-family: sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
        h1, h2, h3 { color: #333; }
        code { background: #f5f5f5; padding: 2px 4px; border-radius: 3px; }
        pre { background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #f8f8f8; font-weight: bold; }
        .warning { background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 5px; margin: 20px 0; }
        .info { background: #e3f2fd; border: 1px solid #bbdefb; padding: 15px; border-radius: 5px; margin: 20px 0; }
        nav { margin-bottom: 20px; }
        nav a { margin-right: 10px; }
    </style>
</head>
<body itemscope itemtype="http://rustybeam.net/ServerConfig">
    <nav>
        <a href="/">Home</a> → 
        <a href="/schema/">Schemas</a> → 
        ServerConfig
    </nav>
    
    <h1>ServerConfig Schema</h1>
    
    <p>The ServerConfig schema defines the main configuration for the Rusty Beam server, including network settings, paths, and daemon behavior for production deployment.</p>

    <h2>Schema Definition</h2>
    
    <p>Schema URL: <code>http://rustybeam.net/ServerConfig</code></p>
    
    <h2>Properties</h2>

    <table>
        <thead>
            <tr>
                <th>Property</th>
                <th>Type</th>
                <th>Required</th>
                <th>Default</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr itemscope itemtype="http://rustybeam.net/Property">
                <td><span itemprop="name">serverRoot</span></td>
                <td><span itemprop="type">Text</span></td>
                <td><span itemprop="cardinality">Optional</span></td>
                <td>./files</td>
                <td><span itemprop="description">The root directory from which static files are served</span></td>
            </tr>
            <tr itemscope itemtype="http://rustybeam.net/Property">
                <td><span itemprop="name">bindAddress</span></td>
                <td><span itemprop="type">Text</span></td>
                <td><span itemprop="cardinality">Optional</span></td>
                <td>0.0.0.0</td>
                <td><span itemprop="description">IP address to bind the server to</span></td>
            </tr>
            <tr itemscope itemtype="http://rustybeam.net/Property">
                <td><span itemprop="name">bindPort</span></td>
                <td><span itemprop="type">Number</span></td>
                <td><span itemprop="cardinality">Optional</span></td>
                <td>3000</td>
                <td><span itemprop="description">Port number to bind the server to</span></td>
            </tr>
            <tr itemscope itemtype="http://rustybeam.net/Property">
                <td><span itemprop="name">daemonPidFile</span></td>
                <td><span itemprop="type">Text</span></td>
                <td><span itemprop="cardinality">Optional</span></td>
                <td>/tmp/rusty-beam.pid</td>
                <td><span itemprop="description">Path to store the process ID file when running as daemon</span></td>
            </tr>
            <tr itemscope itemtype="http://rustybeam.net/Property">
                <td><span itemprop="name">daemonUser</span></td>
                <td><span itemprop="type">Text</span></td>
                <td><span itemprop="cardinality">Optional</span></td>
                <td>None</td>
                <td><span itemprop="description">Username to run daemon as (requires appropriate privileges)</span></td>
            </tr>
            <tr itemscope itemtype="http://rustybeam.net/Property">
                <td><span itemprop="name">daemonGroup</span></td>
                <td><span itemprop="type">Text</span></td>
                <td><span itemprop="cardinality">Optional</span></td>
                <td>None</td>
                <td><span itemprop="description">Group name or ID to run daemon as</span></td>
            </tr>
            <tr itemscope itemtype="http://rustybeam.net/Property">
                <td><span itemprop="name">daemonUmask</span></td>
                <td><span itemprop="type">Text</span></td>
                <td><span itemprop="cardinality">Optional</span></td>
                <td>0o027</td>
                <td><span itemprop="description">File creation mask in octal format (e.g., 0o027, 0o022)</span></td>
            </tr>
            <tr itemscope itemtype="http://rustybeam.net/Property">
                <td><span itemprop="name">daemonStdout</span></td>
                <td><span itemprop="type">Text</span></td>
                <td><span itemprop="cardinality">Optional</span></td>
                <td>/tmp/rusty-beam.stdout</td>
                <td><span itemprop="description">Path to redirect stdout when running as daemon</span></td>
            </tr>
            <tr itemscope itemtype="http://rustybeam.net/Property">
                <td><span itemprop="name">daemonStderr</span></td>
                <td><span itemprop="type">Text</span></td>
                <td><span itemprop="cardinality">Optional</span></td>
                <td>/tmp/rusty-beam.stderr</td>
                <td><span itemprop="description">Path to redirect stderr when running as daemon</span></td>
            </tr>
            <tr itemscope itemtype="http://rustybeam.net/Property">
                <td><span itemprop="name">daemonChownPidFile</span></td>
                <td><span itemprop="type">Boolean</span></td>
                <td><span itemprop="cardinality">Optional</span></td>
                <td>true</td>
                <td><span itemprop="description">Whether to change ownership of PID file to daemon user</span></td>
            </tr>
            <tr itemscope itemtype="http://rustybeam.net/Property">
                <td><span itemprop="name">daemonWorkingDirectory</span></td>
                <td><span itemprop="type">Text</span></td>
                <td><span itemprop="cardinality">Optional</span></td>
                <td>Config file directory</td>
                <td><span itemprop="description">Working directory for the daemon process</span></td>
            </tr>
        </tbody>
    </table>

    <h2>Example Configuration</h2>
    <pre><code>&lt;table itemscope itemtype="http://rustybeam.net/ServerConfig"&gt;
    &lt;tbody&gt;
        &lt;tr&gt;
            &lt;td&gt;Server Root&lt;/td&gt;
            &lt;td&gt;&lt;span itemprop="serverRoot"&gt;./docs&lt;/span&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Bind Address&lt;/td&gt;
            &lt;td&gt;&lt;span itemprop="bindAddress"&gt;127.0.0.1&lt;/span&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Bind Port&lt;/td&gt;
            &lt;td&gt;&lt;span itemprop="bindPort"&gt;3000&lt;/span&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Daemon PID File&lt;/td&gt;
            &lt;td&gt;&lt;span itemprop="daemonPidFile"&gt;/var/run/rusty-beam.pid&lt;/span&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Daemon User&lt;/td&gt;
            &lt;td&gt;&lt;span itemprop="daemonUser"&gt;www-data&lt;/span&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Daemon Group&lt;/td&gt;
            &lt;td&gt;&lt;span itemprop="daemonGroup"&gt;www-data&lt;/span&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Daemon Umask&lt;/td&gt;
            &lt;td&gt;&lt;span itemprop="daemonUmask"&gt;0o027&lt;/span&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Daemon Stdout&lt;/td&gt;
            &lt;td&gt;&lt;span itemprop="daemonStdout"&gt;/var/log/rusty-beam.stdout&lt;/span&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Daemon Stderr&lt;/td&gt;
            &lt;td&gt;&lt;span itemprop="daemonStderr"&gt;/var/log/rusty-beam.stderr&lt;/span&gt;&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;</code></pre>

    <div class="warning">
        <strong>Security Note:</strong> When configuring <code>daemonUser</code> and <code>daemonGroup</code>, ensure the specified user has appropriate permissions to:
        <ul>
            <li>Read the configuration file and server content</li>
            <li>Write to the PID file location</li>
            <li>Write to the stdout/stderr log files</li>
            <li>Bind to the specified port (ports &lt; 1024 require root)</li>
        </ul>
    </div>

    <div class="info">
        <strong>Production Deployment:</strong> For production use, consider:
        <ul>
            <li>Setting <code>daemonPidFile</code> to <code>/var/run/rusty-beam.pid</code></li>
            <li>Using a dedicated user like <code>www-data</code> or <code>rusty-beam</code></li>
            <li>Redirecting logs to <code>/var/log/rusty-beam/</code></li>
            <li>Setting appropriate umask (0o027 prevents others from reading files)</li>
        </ul>
    </div>

    <h2>Daemon Behavior</h2>
    <p>When the server is started without the <code>-v</code> flag, it runs in daemon mode using these settings:</p>
    <ul>
        <li><strong>PID Display:</strong> Shows the process ID before daemonizing</li>
        <li><strong>Process Detachment:</strong> Forks and detaches from the terminal</li>
        <li><strong>File Descriptors:</strong> Redirects stdout/stderr as configured</li>
        <li><strong>Working Directory:</strong> Preserves relative paths in configuration</li>
        <li><strong>User/Group:</strong> Drops privileges if configured</li>
    </ul>

    <h2>See Also</h2>
    <ul>
        <li><a href="/docs/schema/HostConfig/">HostConfig Schema</a> - Per-host configuration</li>
        <li><a href="/docs/">Documentation</a> - Server documentation</li>
        <li><a href="/config/">Configuration Admin</a> - Web-based configuration</li>
    </ul>
    
    <footer>
    </footer>
</body>
</html>